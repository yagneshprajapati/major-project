-- Users Table
CREATE TABLE users (
    user_id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL,
    password VARCHAR(255) NOT NULL,
    registration_date DATETIME NOT NULL,
    address VARCHAR(255),
    phone_number VARCHAR(20),
    is_verified BOOLEAN DEFAULT FALSE
);

-- Airport Table
CREATE TABLE Airport (
    AirportID INT PRIMARY KEY AUTO_INCREMENT,
    AirportName VARCHAR(255) NOT NULL,
    AirportCode CHAR(3) NOT NULL,
    State VARCHAR(255) NOT NULL,
    City VARCHAR(100) NOT NULL,
    Location VARCHAR(100) NOT NULL
);

-- Airline Table
CREATE TABLE IF NOT EXISTS airline (
    email char(40) COLLATE utf8mb4_general_ci NOT NULL,
    pass char(40) COLLATE utf8mb4_general_ci DEFAULT NULL,
    airline_name char(40) COLLATE utf8mb4_general_ci DEFAULT NULL,
    logo char(40) COLLATE utf8mb4_general_ci DEFAULT NULL,
    PRIMARY KEY (email),
    UNIQUE KEY airline_name (airline_name)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Booked Table
CREATE TABLE IF NOT EXISTS booked (
    id int(11) NOT NULL AUTO_INCREMENT,
    flight_id int(11) DEFAULT NULL,
    customer_email char(40) COLLATE utf8mb4_general_ci DEFAULT NULL,
    PRIMARY KEY (id),
    KEY flight_id (flight_id),
    KEY customer_email (customer_email),
    CONSTRAINT booked_ibfk_1 FOREIGN KEY (flight_id) REFERENCES flight (id) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=237 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Flight Table
CREATE TABLE IF NOT EXISTS flight (
    id int(11) NOT NULL AUTO_INCREMENT,
    source_date date DEFAULT NULL,
    source_time time DEFAULT NULL,
    dest_date date DEFAULT NULL,
    dest_time time DEFAULT NULL,
    dep_airport char(40) COLLATE utf8mb4_general_ci DEFAULT NULL,
    arr_airport char(40) COLLATE utf8mb4_general_ci DEFAULT NULL,
    seats int(11) DEFAULT NULL,
    price decimal(12,2) DEFAULT NULL,
    flight_class char(40) COLLATE utf8mb4_general_ci DEFAULT NULL,
    airline_name char(40) COLLATE utf8mb4_general_ci DEFAULT NULL,
    dep_airport_id int(11) DEFAULT NULL,
    arr_airport_id int(11) DEFAULT NULL,
    airline_email char(40) COLLATE utf8mb4_general_ci DEFAULT NULL,
    PRIMARY KEY (id),
    KEY dep_airport_id (dep_airport_id),
    KEY arr_airport_id (arr_airport_id),
    KEY airline_email (airline_email),
    KEY airline_name (airline_name),
    CONSTRAINT flight_ibfk_1 FOREIGN KEY (dep_airport_id) REFERENCES Airport (AirportID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT flight_ibfk_2 FOREIGN KEY (arr_airport_id) REFERENCES Airport (AirportID) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT flight_ibfk_3 FOREIGN KEY (airline_email) REFERENCES airline (email) ON DELETE CASCADE ON UPDATE CASCADE,
    CONSTRAINT flight_ibfk_4 FOREIGN KEY (airline_name) REFERENCES airline (airline_name) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=39 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;
