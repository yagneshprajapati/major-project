<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airport Management System</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <?php include('./include/navbar.php'); ?>
    <div class="container-fluid">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="mt-5">
                    <h2>Airport Management System</h2>

                    <?php
                    // Database connection
                    include("/wamp64/www/shopflix/Admin/connection.php");

                    // Insert airport
                    if (isset($_POST['submit'])) {
                        $airportName = $_POST['airportName'];
                        $airportCode = $_POST['airportCode'];
                        $state = $_POST['state'];
                        $city = $_POST['city'];
                        $location = $_POST['location'];

                        $sql = "INSERT INTO airport (AirportName, AirportCode, State, City, Location) VALUES ('$airportName', '$airportCode', '$state', '$city', '$location')";
                        mysqli_query($conn, $sql);
                    }

                    // Delete airport
                    if (isset($_GET['delete'])) {
                        $airportID = $_GET['delete'];
                        $sql = "DELETE FROM airport WHERE AirportID=$airportID";
                        mysqli_query($conn, $sql);
                    }
                    ?>

                    <form method="post" action="">
                        <div class="form-group">
                            <label for="state">State:</label>
                            <select class="form-control" id="state" name="state" required onchange="populateCities(this.value)">
                                <option value="">Select State</option>
                                <option value="Gujarat">Gujarat</option>
                                <option value="Maharastra">Maharastra</option>
                                <option value="Rajasthan">Rajasthan</option>
                                <option value="UttarPradesh">UttarPradesh</option>
                                <option value="West Bengal">West Bengal</option>
                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                <option value="Punjab">Punjab</option>
                                <option value="Tamil Nadu">Tamil Nadu</option>
                                <option value="Karnataka">Karnataka</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="city">City:</label>
                            <select class="form-control" id="city" name="city" required onchange="populateAirportFields(this.value)">
                                <option value="">Select City</option>
                            </select>
                        </div>
                        <div class="form-group" id="airportNameField" style="display:none;">
                            <label for="airportName">Airport Name:</label>
                            <select class="form-control" id="airportName" name="airportName" required>
                                <option value="">Select Airport Name</option>
                            </select>
                        </div>
                        <div class="form-group" id="airportCodeField" style="display:none;">
                            <label for="airportCode">Airport Code:</label>
                            <select class="form-control" id="airportCode" name="airportCode" required>
                                <option value="">Select Airport Code</option>
                                <!-- Airport codes will be populated dynamically based on the selected city -->
                            </select>
                        </div>
                        <div class="form-group" id="locationField" style="display:none;">
                            <label for="location">Location:</label>
                            <select class="form-control" id="location" name="location" required>
                                <option value="">Select Location</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary" name="submit">Add Airport</button>
                    </form>

                    <h2 class="mt-5">Airports</h2>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Airport Name</th>
                                <th>Airport Code</th>
                                <th>State</th>
                                <th>City</th>
                                <th>Location</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <?php
                            $result = mysqli_query($conn, "SELECT * FROM airport");
                            if ($result) {
                                while ($row = mysqli_fetch_assoc($result)) {
                                    echo "<tr>";
                                    echo "<td>" . $row['AirportName'] . "</td>";
                                    echo "<td>" . $row['AirportCode'] . "</td>";
                                    echo "<td>" . $row['State'] . "</td>";
                                    echo "<td>" . $row['City'] . "</td>";
                                    echo "<td>" . $row['Location'] . "</td>";
                                    echo "<td><a href='?delete=" . $row['AirportID'] . "' class='btn btn-danger'>Delete</a></td>";
                                    echo "</tr>";
                                }
                            } else {
                                echo "Error: " . mysqli_error($conn);
                            }
                            ?>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        function populateCities(selectedState) {
            var cities = [];
            switch (selectedState) {
                case "Gujarat":
                    cities = ["Ahmedabad", "Surat", "Vadodara"];
                    break;
                case "Maharastra":
                    cities = ["Mumbai", "Pune", "Nagpur"];
                    break;
                case "Rajasthan":
                    cities = ["Jaipur", "Jodhpur", "Udaipur", ];
                    break;
                case "UttarPradesh":
                    cities = ["Lucknow", "Kanpur", "Varanasi"];
                    break;
                case "West Bengal":
                    cities = ["Kolkata", "Durgapur", "Siliguri"];
                    break;
                case "Madhya Pradesh":
                    cities = ["Bhopal", "Indore"];
                    break;
                case "Punjab":
                    cities = ["Amritsar", "Chandigarh"];
                    break;
                case "Tamil Nadu":
                    cities = ["Chennai", "Coimbatore"];
                    break;
                case "Karnataka":
                    cities = ["Bengaluru", "Mangalore", "Mysore"];
                    break;
                    // Add cases for other states as needed
                default:
                    cities = [];
            }
            var cityDropdown = document.getElementById("city");
            cityDropdown.innerHTML = ""; // Clear previous options
            cities.forEach(function(city) {
                var option = document.createElement("option");
                option.text = city;
                option.value = city;
                cityDropdown.add(option);
            });
        }

        function populateAirportFields(selectedCity) {
            var airportNames = [];
            var airportCodes = [];
            var locations = [];

            // Assuming these arrays are fetched from your database based on the selected city
            switch (selectedCity) {
                // Cases for different cities...
            }

            var airportNameDropdown = document.getElementById("airportName");
            airportNameDropdown.innerHTML = ""; // Clear previous options
            var airportCodeDropdown = document.getElementById("airportCode");
            airportCodeDropdown.innerHTML = ""; // Clear previous options
            var locationDropdown = document.getElementById("location");
            locationDropdown.innerHTML = ""; // Clear previous options

            airportNames.forEach(function(airportName, index) {
                var nameOption = document.createElement("option");
                nameOption.text = airportName;
                nameOption.value = airportCodes[index]; // Assuming the value is the airport code
                airportNameDropdown.add(nameOption);

                var codeOption = document.createElement("option");
                codeOption.text = airportCodes[index];
                codeOption.value = airportCodes[index];
                airportCodeDropdown.add(codeOption);

                var locationOption = document.createElement("option");
                locationOption.text = locations[index];
                locationOption.value = locations[index];
                locationDropdown.add(locationOption);
            });

            // Show the fields
            document.getElementById("airportNameField").style.display = "block";
            document.getElementById("airportCodeField").style.display = "block";
            document.getElementById("locationField").style.display = "block";
        }
    </script>

</body>

</html>
